#!/bin/bash

. $(type -P utility.sh)

name=$(basename "$1")
dir=$(dirname "$1")
target="${name}.gpg"
if test -f "${target}"; then
    Error "'${target}' alread exists"
fi
tmp=$(mktemp)
Trap "${tmp}"
tar -c -f "${tmp}" -C "${dir}" -h -z "${name}"
gpg --batch --default-recipient-self -o "${target}" -e "${tmp}" </dev/null
