#!/bin/bash

. $(type -P utility.sh)

name=$(basename "$1")
dir=$(dirname "$1")
target="${name}.gpg"
fifo=$(MakeFifo)
if test -f "${target}"; then
    Error "'${target}' alread exists"
fi
tar -c -f "${fifo}" -C "${dir}" -h -z "${name}"
gpg --batch --default-recipient-self -o "${target}" -e "${fifo}"
